<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Unix on Everything is Gray</title><link>https://everythingisgray.com/tags/unix/</link><description>Recent content in Unix on Everything is Gray</description><generator>Hugo</generator><language>en-us</language><copyright>James Barclay</copyright><lastBuildDate>Mon, 19 Oct 2020 00:54:34 -0400</lastBuildDate><atom:link href="https://everythingisgray.com/tags/unix/index.xml" rel="self" type="application/rss+xml"/><item><title>Querying AD Group Membership Status With ldapsearch</title><link>https://everythingisgray.com/2014/01/02/querying-ad-group-membership-status-with-ldapsearch/</link><pubDate>Thu, 02 Jan 2014 00:00:00 +0000</pubDate><guid>https://everythingisgray.com/2014/01/02/querying-ad-group-membership-status-with-ldapsearch/</guid><description>&lt;p>Here&amp;rsquo;s a way to query Active Directory for group membership status with the &lt;code>ldapsearch&lt;/code> utility. In my case, this was used to check if a user is authorized before attempting to mount an SMB share at login on OS X clients. The &lt;code>-Q&lt;/code> option causes &lt;code>ldapsearch&lt;/code> to use &lt;a href="http://en.wikipedia.org/wiki/Simple_Authentication_and_Security_Layer">SASL&lt;/a> quiet mode and not prompt for a password, which works if a &lt;a href="http://web.mit.edu/~kerberos/">Kerberos&lt;/a> ticket is present.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sh" data-lang="sh">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#!/bin/bash
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>console_user&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>&lt;span style="color:#66d9ef">$(&lt;/span>/usr/bin/stat -f%Su /dev/console&lt;span style="color:#66d9ef">)&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ldap_uri&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;ldap://example.com&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>search_base&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;DC=example,DC=com&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>group&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;Some Group&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>is_member_of_group&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">`&lt;/span>/usr/bin/ldapsearch -LLL -Q -H &lt;span style="color:#e6db74">&amp;#34;&lt;/span>$ldap_uri&lt;span style="color:#e6db74">&amp;#34;&lt;/span> -b &lt;span style="color:#e6db74">&amp;#34;&lt;/span>$search_base&lt;span style="color:#e6db74">&amp;#34;&lt;/span> &lt;span style="color:#e6db74">&amp;#34;sAMAccountName=&lt;/span>$console_user&lt;span style="color:#e6db74">&amp;#34;&lt;/span> sAMAccountName | $grep &lt;span style="color:#e6db74">&amp;#34;OU=&lt;/span>$group&lt;span style="color:#e6db74">&amp;#34;&lt;/span>&lt;span style="color:#e6db74">`&lt;/span> &lt;span style="color:#75715e"># -Q prevents the authentication prompt, works if kerberos ticket exists&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#f92672">[[&lt;/span> &lt;span style="color:#e6db74">&amp;#34;&lt;/span>&lt;span style="color:#e6db74">${#&lt;/span>is_member_of_group&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span> -ne &lt;span style="color:#e6db74">&amp;#34;0&amp;#34;&lt;/span> &lt;span style="color:#f92672">]]&lt;/span>; &lt;span style="color:#66d9ef">then&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> echo &lt;span style="color:#e6db74">&amp;#34;&lt;/span>$console_user&lt;span style="color:#e6db74"> is a member of &lt;/span>$group&lt;span style="color:#e6db74">.&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># Do something about it&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">else&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> echo &lt;span style="color:#e6db74">&amp;#34;&lt;/span>$console_user&lt;span style="color:#e6db74"> is NOT a member of &lt;/span>$group&lt;span style="color:#e6db74">.&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># Do something else&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">fi&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>exit $?
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>cURL Speed Test</title><link>https://everythingisgray.com/2013/06/16/curl-speed-test/</link><pubDate>Sun, 16 Jun 2013 00:00:00 +0000</pubDate><guid>https://everythingisgray.com/2013/06/16/curl-speed-test/</guid><description>&lt;p>Have you ever needed to run a quick download speed test, but were too lazy to open up a new browser window and use one of the Web-based tools? Or perhaps you just prefer to use the command-line like me. Never fear, because appending this line to your ~/.bash_profile will allow you test your download speed from within your login shell by simply typing &lt;code>speedtest&lt;/code>.&lt;/p>
&lt;script src="https://gist.github.com/5793955/096a9774362855b5d4290e63813e541e6ffd7a3b.js">&lt;/script></description></item></channel></rss>